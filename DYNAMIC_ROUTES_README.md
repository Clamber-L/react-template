# åŠ¨æ€è·¯ç”±ç³»ç»Ÿæ–‡æ¡£

## æ¦‚è¿°

æœ¬é¡¹ç›®å·²ç»æˆåŠŸå®ç°äº†åŠ¨æ€è·¯ç”±ç³»ç»Ÿï¼Œå°†ç¡¬ç¼–ç çš„è·¯ç”±é…ç½®æ”¹ä¸ºä»æ•°æ®åº“åŠ¨æ€è·å–ã€‚è¿™ä½¿å¾—æ‚¨å¯ä»¥åœ¨ä¸ä¿®æ”¹ä»£ç çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡æ•°æ®åº“é…ç½®æ¥æ§åˆ¶åº”ç”¨çš„è·¯ç”±ç»“æ„ã€‚

## æ ¸å¿ƒç‰¹æ€§

### 1. æ•°æ®åº“é©±åŠ¨
- è·¯ç”±é…ç½®å­˜å‚¨åœ¨æ•°æ®åº“ä¸­
- æ”¯æŒåŠ¨æ€å¢åˆ æ”¹æŸ¥è·¯ç”±
- æ”¯æŒè·¯ç”±çš„å¯ç”¨/ç¦ç”¨çŠ¶æ€æ§åˆ¶

### 2. æƒé™æ§åˆ¶
- åŸºäºç”¨æˆ·è§’è‰²çš„è·¯ç”±è®¿é—®æ§åˆ¶
- æ”¯æŒç»†ç²’åº¦çš„æƒé™é…ç½®
- è‡ªåŠ¨è¿‡æ»¤ç”¨æˆ·æ— æƒè®¿é—®çš„è·¯ç”±

### 3. ç»„ä»¶æ˜ å°„
- é€šè¿‡å­—ç¬¦ä¸²åç§°åŠ¨æ€åŠ è½½ç»„ä»¶
- æ”¯æŒæ‡’åŠ è½½å’Œä»£ç åˆ†å‰²
- é”™è¯¯å¤„ç†å’Œå›é€€æœºåˆ¶

### 4. åµŒå¥—è·¯ç”±
- æ”¯æŒå¤šå±‚çº§åµŒå¥—è·¯ç”±
- æ”¯æŒè·¯ç”±é‡å®šå‘
- å¸ƒå±€ç»„ä»¶å’Œå­è·¯ç”±çš„ç»„åˆ

## æ–‡ä»¶ç»“æ„

```
src/
â”œâ”€â”€ types/route.ts              # è·¯ç”±ç±»å‹å®šä¹‰
â”œâ”€â”€ api/routeApi.ts            # è·¯ç”±APIæ¥å£
â”œâ”€â”€ utils/componentMap.ts      # ç»„ä»¶æ˜ å°„è¡¨
â”œâ”€â”€ components/DynamicRouter.tsx # åŠ¨æ€è·¯ç”±ç”Ÿæˆå™¨
â”œâ”€â”€ data/mockRoutes.ts         # æ¨¡æ‹Ÿæ•°æ®ï¼ˆç”¨äºæ¼”ç¤ºï¼‰
â””â”€â”€ App.tsx                    # åº”ç”¨å…¥å£ï¼ˆå·²ä¿®æ”¹ï¼‰
```

## ä½¿ç”¨æ–¹æ³•

### 1. è·¯ç”±é…ç½®æ•°æ®ç»“æ„

```typescript
interface DynamicRoute {
    id: string;                    // è·¯ç”±å”¯ä¸€æ ‡è¯†
    path: string;                  // è·¯ç”±è·¯å¾„
    component: string;             // ç»„ä»¶åç§°
    name: string;                  // è·¯ç”±åç§°
    meta: RouteMeta;              // å…ƒä¿¡æ¯
    children?: DynamicRoute[];     // å­è·¯ç”±
    enabled: boolean;              // æ˜¯å¦å¯ç”¨
    createTime: string;           // åˆ›å»ºæ—¶é—´
    updateTime: string;           // æ›´æ–°æ—¶é—´
}

interface RouteMeta {
    title: string;                // é¡µé¢æ ‡é¢˜
    icon?: string;               // å›¾æ ‡
    keepAlive?: boolean;         // æ˜¯å¦ç¼“å­˜
    roles?: string[];            // æ‰€éœ€æƒé™è§’è‰²
    hideInMenu?: boolean;        // æ˜¯å¦åœ¨èœå•ä¸­éšè—
    hideInTab?: boolean;         // æ˜¯å¦åœ¨æ ‡ç­¾é¡µä¸­éšè—
    requireAuth?: boolean;       // æ˜¯å¦éœ€è¦è®¤è¯
    redirect?: string;           // é‡å®šå‘è·¯å¾„
}
```

### 2. æ·»åŠ æ–°ç»„ä»¶

è¦æ·»åŠ æ–°çš„é¡µé¢ç»„ä»¶ï¼Œéœ€è¦åœ¨ `src/utils/componentMap.ts` ä¸­æ³¨å†Œï¼š

```typescript
import NewComponent from '@/pages/NewComponent';

export const componentMap: ComponentMap = {
    // ç°æœ‰ç»„ä»¶...
    'NewComponent': NewComponent,
};
```

### 3. æ•°æ®åº“è·¯ç”±é…ç½®ç¤ºä¾‹

```json
{
    "id": "user-management",
    "path": "/system/users",
    "component": "UserManagement",
    "name": "UserManagement",
    "enabled": true,
    "meta": {
        "title": "ç”¨æˆ·ç®¡ç†",
        "icon": "UserOutlined",
        "requireAuth": true,
        "roles": ["admin"]
    }
}
```

### 4. API æ¥å£

ç³»ç»Ÿæä¾›ä»¥ä¸‹APIæ¥å£ï¼š

- `GET /system/routes/user` - è·å–ç”¨æˆ·å¯è®¿é—®çš„è·¯ç”±
- `GET /system/routes` - è·å–æ‰€æœ‰è·¯ç”±é…ç½®
- `POST /system/routes` - åˆ›å»ºæ–°è·¯ç”±
- `PUT /system/routes/:id` - æ›´æ–°è·¯ç”±é…ç½®
- `DELETE /system/routes/:id` - åˆ é™¤è·¯ç”±

## å½“å‰å®ç°çŠ¶æ€

### âœ… å·²å®Œæˆ
1. åŠ¨æ€è·¯ç”±ç±»å‹å®šä¹‰
2. è·¯ç”±APIæ¥å£å®šä¹‰
3. ç»„ä»¶æ˜ å°„ç³»ç»Ÿ
4. åŠ¨æ€è·¯ç”±ç”Ÿæˆå™¨
5. æƒé™æ§åˆ¶é›†æˆ
6. æ¨¡æ‹Ÿæ•°æ®æ¼”ç¤º

### ğŸ”„ å½“å‰ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®
ä¸ºäº†æ¼”ç¤ºåŠŸèƒ½ï¼Œå½“å‰ç³»ç»Ÿä½¿ç”¨ `src/data/mockRoutes.ts` ä¸­çš„æ¨¡æ‹Ÿæ•°æ®ã€‚åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œéœ€è¦ï¼š

1. å®ç°çœŸå®çš„åç«¯API
2. è¿æ¥åˆ°æ•°æ®åº“
3. ç§»é™¤æ¨¡æ‹Ÿæ•°æ®çš„ä½¿ç”¨

### ğŸš€ åˆ‡æ¢åˆ°çœŸå®API

è¦åˆ‡æ¢åˆ°çœŸå®çš„APIï¼Œåªéœ€åœ¨ `DynamicRouter.tsx` ä¸­ï¼š

```typescript
// æ›¿æ¢å½“å‰çš„æ¨¡æ‹Ÿæ•°æ®é€»è¾‘
// const [routeConfig, setRouteConfig] = useState<RouteConfigResponse | null>(null);

// ä½¿ç”¨çœŸå®çš„API
const { data: routeConfig, loading, error, execute } = useApi<RouteConfigResponse>(
    {
        url: '/system/routes/user',
        method: 'GET',
        params: { roles: userRoles.join(',') },
    },
    {
        immediate: true,
        cacheTime: 10 * 60 * 1000,
    },
);
```

## ä¼˜åŠ¿

1. **çµæ´»æ€§**ï¼šæ— éœ€é‡æ–°éƒ¨ç½²å³å¯ä¿®æ”¹è·¯ç”±ç»“æ„
2. **æƒé™æ§åˆ¶**ï¼šç»†ç²’åº¦çš„è®¿é—®æ§åˆ¶
3. **ç»´æŠ¤æ€§**ï¼šé›†ä¸­ç®¡ç†è·¯ç”±é…ç½®
4. **æ‰©å±•æ€§**ï¼šæ˜“äºæ·»åŠ æ–°é¡µé¢å’ŒåŠŸèƒ½
5. **æ€§èƒ½**ï¼šæ”¯æŒç¼“å­˜å’Œæ‡’åŠ è½½

## æ³¨æ„äº‹é¡¹

1. ç¡®ä¿æ•°æ®åº“ä¸­çš„ç»„ä»¶ååœ¨ `componentMap` ä¸­æœ‰å¯¹åº”çš„æ˜ å°„
2. è·¯ç”±è·¯å¾„åº”è¯¥å”¯ä¸€ï¼Œé¿å…å†²çª
3. æƒé™è§’è‰²é…ç½®éœ€è¦ä¸ç”¨æˆ·ç³»ç»Ÿä¿æŒä¸€è‡´
4. è€ƒè™‘è·¯ç”±ç¼“å­˜ç­–ç•¥ä»¥æé«˜æ€§èƒ½

## æ¼”ç¤º

å½“å‰ç³»ç»Ÿå·²ç»å¯åŠ¨å¹¶è¿è¡Œåœ¨ http://localhost:3001ï¼Œæ‚¨å¯ä»¥é€šè¿‡é¢„è§ˆæµè§ˆå™¨è®¿é—®æ¥æŸ¥çœ‹åŠ¨æ€è·¯ç”±çš„æ•ˆæœã€‚

### ğŸ¯ å¿«é€Ÿä½“éªŒ

1. **è®¿é—®åº”ç”¨**ï¼šæ‰“å¼€é¢„è§ˆæµè§ˆå™¨æˆ–ç›´æ¥è®¿é—® http://localhost:3001
2. **ç™»å½•çŠ¶æ€**ï¼šç³»ç»Ÿé»˜è®¤å·²ç™»å½•çŠ¶æ€ï¼ˆæ¼”ç¤ºç”¨é€”ï¼‰ï¼Œç”¨æˆ·å…·æœ‰adminæƒé™
3. **æŸ¥çœ‹åŠ¨æ€è·¯ç”±æ¼”ç¤º**ï¼šå¯¼èˆªåˆ° "ä»ªè¡¨æ¿ > åŠ¨æ€è·¯ç”±æ¼”ç¤º" é¡µé¢
4. **æµ‹è¯•åŠŸèƒ½**ï¼š
   - ä½¿ç”¨å·¦ä¾§èœå•æµè§ˆä¸åŒé¡µé¢
   - ç‚¹å‡»ç™»å‡ºæŒ‰é’®æµ‹è¯•è·¯ç”±é‡å®šå‘
   - è§‚å¯ŸURLå˜åŒ–å’Œæƒé™æ§åˆ¶

### ğŸ”„ é—®é¢˜è§£å†³

å¦‚æœé‡åˆ°404é”™è¯¯ï¼Œè¿™æ˜¯å› ä¸ºï¼š
1. **å·²ä¿®å¤**ï¼šæ·»åŠ äº†æ ¹è·¯å¾„é‡å®šå‘é€»è¾‘
2. **å·²ä¿®å¤**ï¼šæ·»åŠ äº†ç™»å½•çŠ¶æ€æ£€æŸ¥
3. **å·²ä¿®å¤**ï¼šä¼˜åŒ–äº†è·¯ç”±ç”Ÿæˆé¡ºåº

ç°åœ¨è®¿é—® localhost:3001 ä¼šï¼š
- æœªç™»å½•ç”¨æˆ· â†’ è‡ªåŠ¨è·³è½¬åˆ°ç™»å½•é¡µ
- å·²ç™»å½•ç”¨æˆ· â†’ è‡ªåŠ¨è·³è½¬åˆ°å·¥ä½œå°é¦–é¡µ

### ğŸ¨ æ–°å¢åŠŸèƒ½

- **ä¸“é—¨çš„æ¼”ç¤ºé¡µé¢**ï¼š`/dashboard/demo` å±•ç¤ºåŠ¨æ€è·¯ç”±ç³»ç»Ÿçš„å®Œæ•´åŠŸèƒ½è¯´æ˜
- **ç”¨æˆ·å‹å¥½çš„ç•Œé¢**ï¼šè¯¦ç»†å±•ç¤ºå½“å‰ç”¨æˆ·æƒé™å’Œç³»ç»Ÿå·¥ä½œåŸç†
- **äº¤äº’å¼æµ‹è¯•**ï¼šæä¾›ç™»å‡ºã€åˆ·æ–°ç­‰æµ‹è¯•æŒ‰é’®